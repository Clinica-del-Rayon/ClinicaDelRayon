rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {

    // Usuarios pueden subir su foto de perfil
    // También permitir a admins subir fotos de perfil de otros usuarios
    match /usuarios/{userId}/{allPaths=**} {
      allow read: if request.auth != null;
      allow write: if request.auth != null;
    }

    // Vehículos - cualquier usuario autenticado puede subir fotos
    // (esto es necesario porque cuando un admin registra un vehículo para un cliente,
    // el auth.uid es del admin, no del cliente)
    match /vehiculos/{vehiculoId}/{allPaths=**} {
      allow read: if request.auth != null;
      allow write: if request.auth != null;
    }
  }
}

